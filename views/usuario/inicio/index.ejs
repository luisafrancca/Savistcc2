<div class="pag-inicial text-center" style="margin-top: 6%">
  <img
    src="<%= usuario.img ? '/uploads/' + usuario.img : '/assets/default-profile.jpg' %>"
    alt="Foto de perfil"
    class="foto-perfil me-3"
    style="
      width: 100px;
      height: 100px;
    "
  />
  <h1 class="nome-usuario mt-3">Bem-vindo(a), <%= usuario.nome %>!</h1>
</div>

<!-- BLOCO CENTRAL -->
<% if (minhas_viagens && minhas_viagens.length > 0) { %>
<div
  class="bloco-viagens card shadow-sm rounded-4 mt-4"
  style="
    background-color: #f4f8ff;
    width: 90%;
    max-width: 800px;
    margin: 0 auto; /* Centraliza horizontalmente */
    padding: 20px;
    border-radius: 20px;
  "
>
  <p>Próximas viagens:</p>
  <!-- ÁREA SCROLLÁVEL DAS VIAGENS -->
  <div
    class="area-scroll"
    style="
      max-height: 60vh;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: #a7c9f9 #e3ecff;
      padding: 10px;
    "
  >

    <% minhas_viagens.forEach(function(viagem, index) { %>

    <div
      class="card shadow-sm"
      style="
        width: 100%;
        border-radius: 10px;
        background-color: #d1e3fd;
        margin: 10px auto 0 auto; /* centraliza horizontalmente */
      "
    >
      <!-- Cabeçalho -->
      <div
        class="card-header d-flex justify-content-between align-items-center"
        style="
          background-color: #a7c9f9;
          border-top-left-radius: 10px;
          border-top-right-radius: 10px;
        "
      >
        <span class="fw-bold" style="color: #062352; font-size: 16px">
          <%= viagem.cidadeconsul.descricao %>
        </span>
        <span class="fw-bold" style="color: #062352; font-size: 15px">
          <%= viagem.data_viagem.split('-').reverse().join('/') %>
        </span>
      </div>

      <!-- Corpo -->
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center">
          <div class="flex-grow-1"><%= viagem.status.descricao %></div>
          <button class="botao ver-mais-btn">Ver mais</button>
        </div>

        <!-- Detalhes expansíveis -->
        <div
          class="detalhes"
          style="overflow: hidden; height: 0; transition: all 0.3s ease"
        >
          <p>
            <strong>Horário de saída:</strong> <%=
            viagem.horario_saida.substring(0,5) %>
          </p>
          <hr />
          <p>
            <strong>Modelo do carro:</strong> <%= viagem.veiculo.modelo_veiculo
            %>
          </p>
          <hr />
          <p><strong>Placa:</strong> <%= viagem.veiculo.placa %></p>
          <hr />
          <p><strong>Motorista:</strong> <%= viagem.Motorista.nome %></p>
        </div>
      </div>
    </div>

    <% }); %>
  </div>
</div>
<% } %> 

<script>
  // VER MAIS / VER MENOS
  document.querySelectorAll(".ver-mais-btn").forEach((btn) => {
    btn.addEventListener("click", function () {
      const card = this.closest(".card");
      const detalhes = card.querySelector(".detalhes");
      const estaExpandido = detalhes.classList.contains("expandido");

      if (estaExpandido) {
        detalhes.style.height = "0px";
        detalhes.style.marginTop = "0";
        detalhes.classList.remove("expandido");
        this.textContent = "Ver mais";
      } else {
        detalhes.style.height = detalhes.scrollHeight + "px";
        detalhes.style.marginTop = "16px";
        detalhes.classList.add("expandido");
        this.textContent = "Ver menos";
      }
    });
  });

</script>
