<div id="calendario"></div>
<div class="d-flex justify-content-center align-items-center mt-4" style="gap: 70px">
    <a href="/admin/viagens/gerenciar/veiculos?origem=calendario" class="botao-visualizar">Veiculos</a>
    <a href="/admin/viagens/gerenciar/cidades?origem=calendario" class="botao-visualizar">Cidades</a>
</div>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const calendarEl = document.getElementById('calendario');
    if (!calendarEl) return;

    const calendar = new FullCalendar.Calendar(calendarEl, {
      initialView: 'dayGridMonth',
      locale: 'pt-br',
     

      headerToolbar: {
        left: 'title',
        center: '',
        right: 'today prev,next',
      },

      buttonText: {
        today: 'Hoje',
        month: 'MÃªs',
      },

      views: {
        dayGridMonth: {
          titleFormat: { year: 'numeric', month: 'long' },
        },
      },

      events: '/admin/viagens/buscar-eventos',

      dateClick: function (info) {
        const hoje = new Date();
        const dataClicada = new Date(info.dateStr + 'T00:00:00'); 

        const hojeFormatado = new Date(hoje.getFullYear(), hoje.getMonth(), hoje.getDate());
        const clicadaFormatada = new Date(dataClicada.getFullYear(), dataClicada.getMonth(), dataClicada.getDate());

        if (clicadaFormatada < hojeFormatado) {
          return; 
        }

        window.location.href = `/admin/viagens/nova-viagem?data_viagem=${info.dateStr}`;
      },

      dayCellDidMount: function (info) {
        const hoje = new Date();
        const dataCelula = new Date(info.date);

        const hojeFormatado = new Date(hoje.getFullYear(), hoje.getMonth(), hoje.getDate());
        const celulaFormatada = new Date(dataCelula.getFullYear(), dataCelula.getMonth(), dataCelula.getDate());

        if (celulaFormatada < hojeFormatado) {
          info.el.style.opacity = '0.6';
        }
      },
    });

    calendar.render();
  });
</script>
